# 四人语言涌现实验 - 修改总结

## ✅ 已完成的修改

### 1. 创建专用对话脚本 `party_chat.py`
- ✅ 专为四人持续对话设计
- ✅ 支持Novlang语言规则加载
- ✅ 轮流对话机制（4种配对模式）
- ✅ 自动保存进度和检查点
- ✅ 支持断点续传
- ✅ 详细的日志输出

### 2. 修改人物列表 `start.py`
- ✅ 将原来的26个角色精简到4个
- ✅ 保留：伊莎贝拉、玛丽亚、卡门、塔玛拉
- ✅ 原列表已注释保存

### 3. 优化配置文件 `data/config.json`
| 参数 | 原值 | 新值 | 说明 |
|------|------|------|------|
| `think.interval` | 1000 | 500 | 思考间隔减半，提高响应速度 |
| `chat_iter` | 4 | 10 | 对话迭代增加，对话更深入 |
| `associate.retention` | 8 | 12 | 记忆保留增强 |
| `percept.vision_r` | 8 | 10 | 视野范围扩大 |
| `percept.att_bandwidth` | 8 | 10 | 注意力带宽增加 |

### 4. 创建分析工具 `analyze_emergence.py`
- ✅ 符号使用频率统计
- ✅ 组合模式分析
- ✅ 语言涌现指标计算
- ✅ 时间线数据导出
- ✅ 各角色统计

### 5. 创建快捷脚本 `run_experiment.ps1`
支持的操作：
- `start` - 开始新实验
- `resume` - 继续实验
- `analyze` - 分析数据
- `list` - 列出实验
- `view` - 查看对话
- `help` - 帮助信息

### 6. 创建文档
- ✅ `README_实验指南.md` - 快速开始指南
- ✅ `四人对话实验指南.md` - 详细配置说明
- ✅ `修改总结.md` - 本文档

## 🎯 核心改进

### 提高对话效率的策略

1. **人物精简**: 26人 → 4人
   - 减少计算复杂度
   - 提高交互频率
   - 更容易追踪对话

2. **参数优化**: 
   - 响应速度提升2倍
   - 对话深度提升2.5倍
   - 记忆能力提升50%

3. **对话机制优化**:
   - 轮流配对策略（4种组合）
   - 强制对话生成（防止跳过）
   - 自动保存和恢复

4. **分析工具**:
   - 实时追踪语言涌现
   - 量化指标监控
   - 可视化数据导出

## 📊 使用流程

```
1. 准备环境
   conda activate generative_agents_cn
   ↓
2. 启动实验
   .\run_experiment.ps1 -Action start -Name "test-1" -Rounds 100
   ↓
3. 实时监控
   Get-Content results\party_chat\test-1\rounds.json -Tail 20
   ↓
4. 分析结果
   python analyze_emergence.py results\party_chat\test-1\rounds.json
   ↓
5. 调整优化
   修改 data/config.json 参数
   ↓
6. 继续实验
   .\run_experiment.ps1 -Action resume -Name "test-1" -Rounds 100
```

## 🔧 关键文件位置

```
generative_agents/
├── party_chat.py              # 主实验脚本 ⭐
├── analyze_emergence.py       # 分析工具 ⭐
├── run_experiment.ps1         # 快捷脚本 ⭐
├── start.py                   # 传统模拟（已修改）
├── README_实验指南.md         # 快速指南 📖
├── 四人对话实验指南.md        # 详细指南 📖
├── data/
│   ├── config.json           # 配置文件（已优化）⚙️
│   └── prompts/
│       ├── novlang_rules.txt # Novlang规则
│       └── generate_chat.txt # 对话提示词
└── results/
    └── party_chat/           # 实验结果目录
        └── your-experiment/
            ├── rounds.json   # 对话记录
            └── checkpoint-*.json
```

## 🚀 立即开始

### 最简单的方式

```powershell
cd generative_agents
.\run_experiment.ps1 -Action start -Name "my-first-test" -Rounds 50
```

### 完整命令

```powershell
python party_chat.py `
  --name lang-emerge-1 `
  --rounds 100 `
  --novlang-file data\prompts\novlang_rules.txt `
  --verbose info
```

## 📈 预期效果

### 短期（1-10轮）
- ✅ agents开始使用Novlang符号
- ✅ 基本的对话流程建立
- ✅ 符号使用模式初步形成

### 中期（10-100轮）
- ✅ 出现稳定的符号组合
- ✅ 对话效率逐渐提高
- ✅ 形成共享的表达习惯

### 长期（100+轮）
- ✅ 完整的通信协议涌现
- ✅ 创新表达方式出现
- ✅ 语义系统自发演化

## 🔍 监控指标

### 核心指标
1. **符号多样性**: 目标 >80%
2. **稳定组合数**: 目标 >10个
3. **对话流畅度**: 无重复、无中断
4. **语义收敛**: 符号意义趋于一致

### 查看方式
```powershell
# 运行分析工具
python analyze_emergence.py results\party_chat\test-1\rounds.json

# 查看输出的"语言涌现指标"部分
```

## ⚠️ 注意事项

1. **确保Ollama运行**: 
   ```powershell
   curl http://127.0.0.1:11434/api/tags
   ```

2. **模型已加载**: 
   ```powershell
   ollama list
   # 应该看到 qwen3:8b-q4_K_M
   ```

3. **足够的磁盘空间**: 
   - 100轮约需 5-10MB
   - 1000轮约需 50-100MB

4. **实验命名规范**:
   - 使用有意义的名称
   - 记录参数设置
   - 保留实验笔记

## 🐛 常见问题

### Q1: 对话不够频繁怎么办？
**A**: 进一步减少 `think.interval` 到 300ms，增加 `chat_iter` 到 15

### Q2: agents不使用Novlang？
**A**: 检查 `--novlang-file` 参数，确认 `generate_chat.txt` 包含规则

### Q3: 程序运行缓慢？
**A**: 
- 使用更小的模型（如 qwen2.5:7b-instruct-q4_K_M）
- 减少 `chat_iter`
- 增加 `interval`

### Q4: 如何恢复中断的实验？
**A**: 使用 `--resume` 参数：
```powershell
python party_chat.py --name test-1 --resume --rounds 100 --novlang-file data\prompts\novlang_rules.txt
```

## 💡 高级优化

### 1. 调整对话配对策略
编辑 `party_chat.py` 的 `agent_pairs`，改变谁和谁对话

### 2. 修改Novlang规则
编辑 `data/prompts/novlang_rules.txt`，添加新符号或规则

### 3. 自定义提示词
编辑 `data/prompts/generate_chat.txt`，优化对话生成

### 4. 并行实验
同时运行多个实验，比较不同参数的效果

## 📚 下一步探索

1. **变量实验**:
   - 尝试不同的人物组合
   - 测试不同的语言规则
   - 比较不同的LLM模型

2. **数据分析**:
   - 创建可视化图表
   - 统计学分析
   - 机器学习建模

3. **理论验证**:
   - 验证语言涌现假设
   - 研究共识形成机制
   - 分析创新扩散过程

## 🎉 总结

现在你拥有：
- ✅ 一个高效的四人对话系统
- ✅ 优化的配置参数
- ✅ 完整的分析工具
- ✅ 详细的使用文档
- ✅ 便捷的运行脚本

**一切准备就绪，开始你的语言涌现实验吧！** 🚀

---

如有问题或需要进一步优化，请参考：
- `README_实验指南.md` - 快速开始
- `四人对话实验指南.md` - 详细说明
- 项目原始README - 基础概念

祝实验顺利！ 🎊
